@{
    var LoginName = "游客";
    bool flag = false;
    var RoleId = -1;

    FindJob.Model.T_Base_User item = new FindJob.Model.T_Base_User();
    if (HttpContext.Current.User == null)
    {
        return;
    }
    else
    {
        flag = true;
        try
        {
            var ticket = (HttpContext.Current.User.Identity as FormsIdentity).Ticket;
            LoginName = ticket.Name;
            RoleId = ticket.Version;
        }
        catch(Exception e)
        {
            flag = false;
        }


    }
    //测试
    LoginName = "1231";
    item = new FindJob.BLL.T_Base_User().Find(LoginName);

    //item.Id
}




<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Dashboard">
    <meta name="keyword" content="Dashboard, Bootstrap, Admin, Template, Theme, Responsive, Fluid, Retina">

    <title>我要找工作</title>

    <!-- Bootstrap core CSS -->
    <link href="/assets/css/bootstrap.css" rel="stylesheet">
    <!--external css-->
    <link href="/assets/font-awesome/css/font-awesome.css" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="/assets/css/zabuto_calendar.css">
    <link rel="stylesheet" type="text/css" href="/assets/js/gritter/css/jquery.gritter.css" />
    <link rel="stylesheet" type="text/css" href="/assets/lineicons/style.css">

    <!-- Custom styles for this template -->
    <link href="/assets/css/style.css" rel="stylesheet">
    <link href="/assets/css/style-responsive.css" rel="stylesheet">

    <script src="/assets/js/chart-master/Chart.js"></script>
    @RenderSection("css",false)

   
</head>

<body>
    <section id="container">
        <!-- **********************************************************************************************************************************************************
    TOP BAR CONTENT & NOTIFICATIONS
    *********************************************************************************************************************************************************** -->
        <!--header start-->
        <header class="header black-bg" style="background: #68dff0;">
            <div class="sidebar-toggle-box">
                <div class="fa fa-bars tooltips" data-placement="right" data-original-title="Toggle Navigation"></div>
            </div>
            <!--logo start-->
            <a href="index.html" class="logo"><b>找工作</b></a>
            <!--logo end-->
            <div class="nav notify-row" id="top_menu">

                <!--  notification end -->
            </div>
            <div class="top-menu">
                <ul class="nav pull-right top-menu">
                    <li><a class="logout" href="/home/loginout">退出登录</a></li>
                </ul>
            </div>
        </header>
        <!--header end-->
        <!-- **********************************************************************************************************************************************************
    MAIN SIDEBAR MENU
    *********************************************************************************************************************************************************** -->
        <!--sidebar start-->
        <aside>
            <div id="sidebar" class="nav-collapse ">
                <!-- sidebar menu start-->
                <ul class="sidebar-menu" id="nav-accordion">

                    <p class="centered"><a data-toggle="modal" data-target="#register" href=""><img src=@item.Pic class="img-circle" width="60"></a></p>

                    <li class="mt">
                        <a class="active" href="/home/index">
                            <i class="fa fa-dashboard"></i>
                            <span>面板</span>
                        </a>
                    </li>

                    <li class="sub-menu">
                        <a href="javascript:;">
                            <i class="fa fa-desktop"></i>
                            <span>企业管理</span>
                        </a>
                        <ul class="sub">
                            <li><a href="/Admin/EPIndex">企业列表</a></li>

                        </ul>
                    </li>


                    <li class="sub-menu">
                        <a href="javascript:;">
                            <i class="fa fa-desktop"></i>
                            <span>学生管理</span>
                        </a>
                        <ul class="sub">
                            <li><a href="/Admin/StuIndex">学生列表</a></li>
                            <li><a href="/Admin/ApplyJobIndex">求职学生列表</a></li>
                            <li><a href="/Admin/EIIndex">就业学生列表</a></li>
                            <li><a href="/Admin/InStu">批量导入</a></li>
                        </ul>
                    </li>


                    <li class="sub-menu">
                        <a href="javascript:;">
                            <i class="fa fa-desktop"></i>
                            <span>信息审核</span>
                        </a>
                        <ul class="sub">
                            <li><a href="/Admin/EPCheck">企业信息审核</a></li>
                            <li><a href="/Admin/StuCheckIndex">学生信息审核</a></li>
                            <li><a href="/Admin/EICheckIndex">学生就业审核</a></li>
                        </ul>
                    </li>

                    <li class="sub-menu">
                        <a href="javascript:;">
                            <i class="fa fa-desktop"></i>
                            <span>企业功能</span>
                        </a>
                        <ul class="sub">
                            <li><a href="/Enterprise/Index">功能1</a></li>
                            <li><a href="/Enterprise/Index">功能2</a></li>
                            <li><a href="/Enterprise/Index">功能3</a></li>
                            <li><a href="/Enterprise/Index">功能4</a></li>
                        </ul>
                    </li>

                    @*@{

                        foreach (Book.Model.Menu menu in lst.Where(m => m.ParentId == 0 && m.Type == 2))
                        {
                            <li class="sub-menu">
                                <a href="javascript:;">
                                    <i class="fa fa-desktop"></i>
                                    <span>@menu.Display</span>
                                </a>
                                <ul class="sub">
                                    @foreach (Book.Model.Menu subMenu in lst.Where(m => m.ParentId == menu.Id && m.Type == 1))
                                    {
                                        <li><a href="/@subMenu.Controller/@subMenu.Action">@subMenu.Display</a></li>
                                    }

                                </ul>
                            </li>


                        }
                    }*@
                    @*<li class="sub-menu">
                        <a href="javascript:;">
                            <i class="fa fa-desktop"></i>
                            <span>基础管理</span>
                        </a>
                        <ul class="sub">
                            <li><a href="/book/Index">书籍管理</a></li>
                            <li><a href="/provider/index">供应商管理</a></li>
                            <li><a href="#">客户管理</a></li>
                            <li><a href="#">用户管理</a></li>
                        </ul>
                    </li>*@

                </ul>
                <!-- sidebar menu end-->
            </div>
        </aside>
        <!--sidebar end-->
        @*<div class="copyrights">Collect from <a href="http://www.cssmoban.com/">网页模板</a></div>*@

        <!-- **********************************************************************************************************************************************************
    MAIN CONTENT
    *********************************************************************************************************************************************************** -->
        <!--main content start-->
        @{
            if (item.LoginName.Equals("游客"))
            {

                <div id="register" class="modal fade" tabindex="-1">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-body">
                                <button class="close" data-dismiss="modal">
                                    <span>&times;</span>
                                </button>
                            </div>

                            <div class="modal-body">
                                <form class="form-group" action="">
                                    <div class="title text-center ">
                                            注册
                                    </div>

                                    <div class="form-group">
                                        <label for="">用户名</label>
                                        <input class="form-control" type="text" placeholder="6-15位字母或数字">
                                    </div>
                                    <div class="form-group">
                                        <label for="">密码</label>
                                        <input class="form-control" type="password" placeholder="至少6位字母或数字">
                                    </div>
                                    <div class="form-group">
                                        <label for="">再次输入密码</label>
                                        <input class="form-control" type="password" placeholder="至少6位字母或数字">
                                    </div>
                                    <div class="form-group">
                                        <label for="">邮箱</label>
                                        <input class="form-control" type="email" placeholder="例如:123@123.com">
                                    </div>
                                    <div class="text-right">
                                        <button class="btn btn-primary" type="submit">提交</button>
                                        <button class="btn btn-danger" data-dismiss="modal">取消</button>
                                    </div>
                                    <a href="" data-toggle="modal" data-dismiss="modal" data-target="#login">已有账号？点我登录</a>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            }
            else
            {
                <div id="register" class="modal fade" tabindex="-1">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-body">
                                <button class="close" data-dismiss="modal">
                                    <span>&times;</span>
                                </button>
                            </div>

                            <div class="modal-body">
                                <form class="form-group" action="/home/editsave" enctype="multipart/form-data" method="post">
                                    <div class="title text-center ">
                                        修改个人信息
                                    </div>
                                    <div class="form-group">
                                        
                                        <a href="javascript:void(0)" class="newspic">
                                            <!-- static/img/selectimg.png是默认图片，当reader读取完毕后，执行步骤8，即展示上传图片 -->
                                            <img id ="tmpPic"class="img-rounded center-block" width="60" src=@item.Pic />
                                        </a>
                                        <input type="file" id="Pic" name="Pic"  onchange="showPic(this)" style="display: none" />
                                        <input type="text" id="Id" name ="Id" class="hidden" value="@item.Id">
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="">密码</label>
                                        <input class="form-control" type="password" name = "Password" placeholder="请输入新的密码">
                                    </div>

                                    <div class="form-group">
                                        <label for="">手机号</label>
                                        <input class="form-control" type="text" name="Phone" value="@item.Phone">
                                    </div>
                                    <div class="text-right">
                                        <button class="btn btn-primary" type="submit">更改</button>
                                        <button class="btn btn-danger" data-dismiss="modal">取消</button>
                                    </div>
                                    <a href="" data-toggle="modal" data-dismiss="modal" data-target="#login">已有账号？点我登录</a>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            }

        }

        @RenderBody()

        <!--main content end-->
        <!--footer start-->
        @*<footer class="site-footer">
            <div class="text-center">
                2014 - Alvarez.is - More Templates <a href="http://www.cssmoban.com/" target="_blank" title="模板之家">模板之家</a> - Collect from <a href="http://www.cssmoban.com/" title="网页模板" target="_blank">网页模板</a>
                <a href="index.html#" class="go-top">
                    <i class="fa fa-angle-up"></i>
                </a>
            </div>
        </footer>*@
        <!--footer end-->
    </section>

    <!-- js placed at the end of the document so the pages load faster -->
    <script src="/assets/js/jquery.js"></script>
    <script src="/assets/js/jquery-1.8.3.min.js"></script>
    <script src="/assets/js/bootstrap.min.js"></script>
    <script class="include" type="text/javascript" src="/assets/js/jquery.dcjqaccordion.2.7.js"></script>
    <script src="/assets/js/jquery.scrollTo.min.js"></script>
    <script src="/assets/js/jquery.nicescroll.js" type="text/javascript"></script>
    <script src="/assets/js/jquery.sparkline.js"></script>


    <!--common script for all pages-->
    <script src="/assets/js/common-scripts.js"></script>

    <script type="text/javascript" src="/assets/js/gritter/js/jquery.gritter.js"></script>
    <script type="text/javascript" src="/assets/js/gritter-conf.js"></script>

    <!--script for this page-->
    <script src="/assets/js/sparkline-chart.js"></script>
    <script src="/assets/js/zabuto_calendar.js"></script>

    <script type="text/javascript">
        //$(document).ready(function () {
        //var unique_id = $.gritter.add({
        //    // (string | mandatory) the heading of the notification
        //    title: 'Welcome to Dashgum!',
        //    // (string | mandatory) the text inside the notification
        //    text: 'Hover me to enable the Close Button. You can hide the left sidebar clicking on the button next to the logo. Free version for <a href="" target="_blank" style="color:#ffd777">BlackTie.co</a>.',
        //    // (string | optional) the image to display on the left
        //    image: '/assets/img/ui-sam.jpg',
        //    // (bool | optional) if you want it to fade out on its own or just sit there
        //    sticky: true,
        //    // (int | optional) the time you want it to be alive for before fading out
        //    time: '',
        //    // (string | optional) the class name you want to apply to that specific message
        //    class_name: 'my-sticky-class'
        //});

        //return false;
        //});

         @RenderSection("js", false)
        $(".newspic").click(function () {    //1.点击默认图片，出发标签<a>的click事件
            $(this).next('input').click();//2.触发input的点击事件，用户选择图片进行上传
        });
        //$("#Pic").change(function () {
        //    var data = $("#Pic").val();
        //    console.log(data)
        //    //if (data.files && data.files[0]) {//4.判断input标签的file是否存在
        //    //    var reader = new FileReader();//5.实例化一个FileReader()接口
        //    //    reader.readAsDataURL(data.files[0]);//6.通过readAsDataURL()方法读取文件，将图片内嵌在网页之中
        //    //    reader.onload = function (evt) {//7.调用FileReader()的onload事件，当文件读取成功时，执行8
        //    //        //8.将reader的result属性值赋值给data.parentNode.childNodes[1].childNodes[1].src，实现图片预览
        //    //        data.parentNode.childNodes[1].childNodes[1].src = evt.target.result;
        //    //    }
        //    //}
        //    $(".newspic").attr("src", data);

        //});
        function showPic(data) {//3.当用户上传图片后，触发input标签的onchange事件，执行showPic()方法
            //data = $("#Pic");
            if (data.files && data.files[0]) {//4.判断input标签的file是否存在
                var reader = new FileReader();//5.实例化一个FileReader()接口
                reader.readAsDataURL(data.files[0]);//6.通过readAsDataURL()方法读取文件，将图片内嵌在网页之中
                reader.onload = function (evt) {//7.调用FileReader()的onload事件，当文件读取成功时，执行8
                    //8.将reader的result属性值赋值给data.parentNode.childNodes[1].childNodes[1].src，实现图片预览
                    //data.parentNode.childNodes[1].childNodes[1].src = evt.target.result;
                    $("#tmpPic").attr("src", evt.target.result);
                }
            }
        }
    </script>


    <script type="application/javascript">
        $(document).ready(function () {
            $("#date-popover").popover({html: true, trigger: "manual"});
            $("#date-popover").hide();
            $("#date-popover").click(function (e) {
                $(this).hide();
            });

            $("#my-calendar").zabuto_calendar({
                action: function () {
                    return myDateFunction(this.id, false);
                },
                action_nav: function () {
                    return myNavFunction(this.id);
                },
                ajax: {
                    url: "show_data.php?action=1",
                    modal: true
                },
                legend: [
                    {type: "text", label: "Special event", badge: "00"},
                    {type: "block", label: "Regular event", }
                ]
            });
        });


        function myNavFunction(id) {
            $("#date-popover").hide();
            var nav = $("#" + id).data("navigation");
            var to = $("#" + id).data("to");
            console.log('nav ' + nav + ' to: ' + to.month + '/' + to.year);
        }
    </script>


</body>
</html>
